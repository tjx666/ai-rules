# å·¥å…·è°ƒç”¨å®Œæ•´æŒ‡å—

## ğŸ”§ ç¯å¢ƒè¯´æ˜

### å¼€å‘ç¯å¢ƒ

- **OS**: macOS 15.5
- **Hardware**: Apple Silicon (M4 Pro)
- **IDE**: Cursorï¼ˆVSCode çš„ forkï¼‰
- **Default Terminal Editor**: `cursor`

ä½ å·²ç»å¤„åœ¨ä¸€ä¸ªæ‰“å¼€çš„ Cursor å·¥ä½œåŒºç¯å¢ƒä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰ vscode-mcp æä¾›çš„å·¥å…·ã€‚

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

### 1. å·¥å…·é€‰æ‹©ä¼˜å…ˆçº§

1. **å…·ä½“ä»£ç ä½ç½®å·²çŸ¥** â†’ ä¼˜å…ˆä½¿ç”¨ VSCode LSP å·¥å…·
2. **éœ€è¦æ¢ç´¢å’Œæœç´¢** â†’ ä½¿ç”¨å†…ç½®æœç´¢å·¥å…·
3. **å¤æ‚æ“ä½œéœ€æ±‚** â†’ ä½¿ç”¨ç»ˆç«¯å‘½ä»¤è¡Œå·¥å…·

### 2. åŸºæœ¬åŸåˆ™

- codebase_search, grep_search, file_search é€‚åˆåœ¨ä¸æ¸…æ¥šä»£ç ä½ç½®æ—¶æ”¶é›†ä¸Šä¸‹æ–‡
- vscode-mcp æä¾›çš„ LSP tools é€‚åˆåœ¨æ¸…æ¥šä»£ç ä½ç½®æ—¶è·å–ç²¾ç¡®ä»£ç ä¿¡æ¯
- ç»ˆç«¯å·¥å…·é€‚åˆåœ¨å†…ç½®å·¥å…·æ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ä½¿ç”¨

## ğŸ› ï¸ å·¥å…·åˆ†ç±»è¯¦è§£

### 1. VSCode MCP LSP å·¥å…·ï¼ˆç²¾ç¡®ä»£ç åˆ†æï¼‰

| å·¥å…·åç§°             | ç”¨é€”               | ä½¿ç”¨åœºæ™¯                                 |
| -------------------- | ------------------ | ---------------------------------------- |
| `get_definition`     | è·å–ç¬¦å·å®šä¹‰       | æŸ¥çœ‹å‡½æ•°/å˜é‡çš„å®šä¹‰ä½ç½®                  |
| `get_references`     | æŸ¥æ‰¾æ‰€æœ‰å¼•ç”¨ä½ç½®   | è¯„ä¼°ä¿®æ”¹å½±å“èŒƒå›´                         |
| `get_hovers`         | è·å–ç±»å‹ä¿¡æ¯å’Œæ–‡æ¡£ | ç†è§£ä»£ç å«ä¹‰å’Œç±»å‹                       |
| `get_diagnostics`    | è·å–é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯ | æ’æŸ¥ä»£ç é—®é¢˜ï¼Œæ£€æŸ¥ç¼–è¾‘æ–‡ä»¶æ²¡æœ‰å¼•å…¥æ–°é”™è¯¯ |
| `get_signature_help` | è·å–å‡½æ•°ç­¾åå¸®åŠ©   | è°ƒç”¨å‡½æ•°æ—¶è·å–å‚æ•°ä¿¡æ¯                   |
| `rename_symbol`      | é‡å‘½åç¬¦å·         | å®‰å…¨, å‡†ç¡®åœ°é‡æ„ä»£ç                      |
| `highlight_code`     | é«˜äº®æ˜¾ç¤ºä»£ç åŒºåŸŸ   | ç”¨æˆ·å‹å¥½ï¼Œå¯è§†åŒ–å‘ç”¨æˆ·å±•ç¤ºé‡è¦ä»£ç ç‰‡æ®µ   |

#### ğŸ¯ ä»£ç é«˜äº®æœ€ä½³å®è·µï¼ˆä»…ç”¨äºæŸ¥æ‰¾ç±»è¯·æ±‚ï¼‰

**æ ¸å¿ƒåŸåˆ™**ï¼š**ä»…å½“ç”¨æˆ·æ˜ç¡®è¦æ±‚æŸ¥æ‰¾ã€å®šä½ä»£ç æ—¶**ï¼Œæ‰ä½¿ç”¨ `highlight_code` å¯¹æœ€ç»ˆæ‰¾åˆ°çš„ç»“æœè¿›è¡Œå¯è§†åŒ–å±•ç¤ºã€‚

- **é€‚ç”¨åœºæ™¯**ï¼šç”¨æˆ·çš„è¯·æ±‚åŒ…å«â€œæŸ¥æ‰¾â€ã€â€œå®šä½â€ã€â€œåœ¨å“ªé‡Œâ€ã€â€œå¸®æˆ‘çœ‹çœ‹â€ç­‰å…³é”®è¯ï¼Œæ˜ç¡®æŒ‡å‘ä¸€ä¸ªæ¢ç´¢å’Œå®šä½ä»£ç çš„ç›®çš„ã€‚
- **ç¦æ­¢åœºæ™¯**ï¼šå¯¹äºæ‰§è¡Œç±»ä»»åŠ¡ï¼ˆå¦‚â€œé‡æ„â€ã€â€œå®ç°â€ã€â€œä¿®æ”¹â€ï¼‰ï¼Œåœ¨å®Œæˆä»»åŠ¡åè¿›è¡Œæˆæœæ±‡æŠ¥æ—¶ï¼Œ**ç¦æ­¢**ä½¿ç”¨ `highlight_code` æ¥å±•ç¤ºä½ ä¿®æ”¹æˆ–åˆ›å»ºçš„ä»£ç ï¼Œé™¤éç”¨æˆ·åç»­æ˜ç¡®è¦æ±‚ä½ é«˜äº®å±•ç¤ºã€‚

**ç¤ºä¾‹ï¼š**

- âœ… **æ­£ç¡®ä½¿ç”¨**: ç”¨æˆ·: "å¸®æˆ‘æ‰¾åˆ°å¤„ç†ç”¨æˆ·è®¤è¯çš„é€»è¾‘" -> (åˆ†æå) -> `highlight_code(...)`
- âŒ **é”™è¯¯ä½¿ç”¨**: ç”¨æˆ·: "å¸®æˆ‘é‡æ„è®¤è¯é€»è¾‘" -> (é‡æ„å) -> "é‡æ„å·²å®Œæˆï¼Œè¯·çœ‹é«˜äº®éƒ¨åˆ†" -> `highlight_code(...)`

### 2. å†…ç½®æœç´¢å·¥å…·ï¼ˆä»£ç æ¢ç´¢ï¼‰

å®ƒä»¬çš„ç”¨é€”å’Œé™åˆ¶ä½ å·²ç»å¾ˆæ¸…æ¥šäº†ï¼Œè¿™é‡Œä¸åŠ èµ˜è¿°ã€‚

### 3. ç»ˆç«¯å‘½ä»¤è¡Œå·¥å…·ï¼ˆå¤æ‚æ“ä½œï¼‰

é€šè¿‡ `run_terminal_cmd` ä½¿ç”¨ä»¥ä¸‹ç°ä»£åŒ–å·¥å…·ï¼š

| ä»»åŠ¡ç±»å‹     | ä¼ ç»Ÿå·¥å…·     | **æ¨èå·¥å…·**       | ä½¿ç”¨ç†ç”±              |
| ------------ | ------------ | ------------------ | --------------------- |
| **æ–‡ä»¶æŸ¥æ‰¾** | `find`       | `fd`               | æ›´å¿«é€Ÿã€è¯­æ³•å‹å¥½      |
| **ä»£ç æœç´¢** | `grep`       | `ripgrep` (`rg`)   | æå¿«ã€éµå®ˆ .gitignore |
| **ä»£ç é‡æ„** | `sed`        | `ast-grep`         | è¯­æ³•æ„ŸçŸ¥ã€å®‰å…¨é‡æ„    |
| **Git æ“ä½œ** | `git`        | `gh`               | GitHub é›†æˆ           |
| **åŒ…ç®¡ç†**   | `npm`/`pnpm` | `@antfu/ni` (`ni`) | ç»Ÿä¸€çš„åŒ…ç®¡ç†å™¨å‘½ä»¤    |
| **è¿è¡Œè„šæœ¬** | `node`       | `tsx`              | ç›´æ¥è¿è¡Œ TypeScript   |

å…¶ä»–å¯ç”¨çš„ shell å·¥å…·ï¼š

- **æ–‡ä»¶æŸ¥çœ‹**: `bat`ï¼ˆè¯­æ³•é«˜äº® catï¼‰ã€`delta`ï¼ˆæ›´å¥½çš„ git diffï¼‰
- **ç³»ç»Ÿåˆ†æ**: `dust`ï¼ˆç£ç›˜ä½¿ç”¨ï¼‰ã€`tokei`ï¼ˆä»£ç ç»Ÿè®¡ï¼‰
- **ç­‰å¾…æ§åˆ¶**: `sleep`ï¼ˆæš‚åœæ‰§è¡Œï¼Œä¸»åŠ¨ç­‰å¾…ï¼‰
- **ä»£ç é‡æ„**: `ast-grep`ï¼ˆè¯­æ³•æ„ŸçŸ¥çš„æœç´¢å’Œæ›¿æ¢ï¼‰

#### ğŸ¯ ast-grep è¯¦è§£ï¼ˆè¯­æ³•æ„ŸçŸ¥çš„ä»£ç é‡æ„ï¼‰

`ast-grep` åŸºäº ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰çš„æœç´¢å’Œæ›¿æ¢å·¥å…·ï¼Œæ ¸å¿ƒåœºæ™¯ï¼š

**1. å¤§è§„æ¨¡ç®€å•é‡æ„**

- æ‰¹é‡æ›¿æ¢ä¸€ä¸ªæ¨¡å¼çš„ä»£ç åˆ°å¦ä¸€ä¸ªæ¨¡å¼
- ä¼˜äº `sed`ï¼šè¯­æ³•æ„ŸçŸ¥ï¼Œä¸ä¼šè¯¯æ›¿æ¢å­—ç¬¦ä¸²ã€æ³¨é‡Š
- âš ï¸ **é™åˆ¶**ï¼šåªé€‚åˆç®€å•çš„å¤§è§„æ¨¡é‡æ„ï¼Œå¤æ‚çš„é‡æ„è¿˜æ˜¯éœ€è¦ä¸€ä¸ªä¸€ä¸ªæ”¹

**2. å¤æ‚æ¨¡å¼æœç´¢**

- åŸºäº AST çš„æœç´¢æ•ˆæœæ›´å¥½
- æ”¯æŒå¤æ‚çš„ä»£ç æ¨¡å¼åŒ¹é…

## ğŸ¯ å†³ç­–æµç¨‹å›¾

```plaintext
é—®é¢˜ï¼šéœ€è¦å¤„ç†ä»£ç ç›¸å…³ä»»åŠ¡

1. æˆ‘çŸ¥é“å…·ä½“çš„ä»£ç ä½ç½®å—ï¼Ÿ
   â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ VSCode LSP å·¥å…·
   â”‚   â”œâ”€ æŸ¥çœ‹å®šä¹‰ â†’ get_definition
   â”‚   â”œâ”€ æŸ¥æ‰¾å¼•ç”¨ â†’ get_references
   â”‚   â”œâ”€ è·å–ç±»å‹ â†’ get_hovers
   â”‚   â”œâ”€ æ£€æŸ¥é”™è¯¯ â†’ get_diagnostics
   â”‚   â””â”€ å±•ç¤ºä»£ç  â†’ highlight_code
   â””â”€ å¦ â†’ ç»§ç»­ä¸‹ä¸€æ­¥

2. æˆ‘çŸ¥é“è¦æŸ¥æ‰¾ä»€ä¹ˆå—ï¼Ÿ
   â”œâ”€ çŸ¥é“å…·ä½“ä»£ç /å‡½æ•°å â†’ grep_search æˆ– rg
   â”œâ”€ éœ€è¦ç†è§£åŠŸèƒ½/æ¦‚å¿µ â†’ codebase_search
   â”œâ”€ åªçŸ¥é“æ–‡ä»¶å â†’ file_search æˆ– fd
   â””â”€ éœ€è¦ä»£ç é‡æ„/æ‰¹é‡æ›¿æ¢ â†’ ast-grep

3. éœ€è¦è¿›è¡Œä»€ä¹ˆæ“ä½œï¼Ÿ
   â”œâ”€ åŒ…ç®¡ç† â†’ ni/nr/nun
   â”œâ”€ è¿è¡Œè„šæœ¬ â†’ tsx
   â”œâ”€ Git æ“ä½œ â†’ gh
   â””â”€ ä»£ç é‡æ„ â†’ ast-grep æˆ– rename_symbol
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å·¥å…·ç»„åˆä½¿ç”¨

```plaintext
æœç´¢å·¥å…·æ‰¾ä½ç½® â†’ LSP å·¥å…·è·å–è¯¦ç»†ä¿¡æ¯ â†’ ç»ˆç«¯å·¥å…·æ‰§è¡Œæ“ä½œ
```

### 2. é€‰æ‹©ç­–ç•¥

- **å†…ç½®å·¥å…·ä¼˜å…ˆ**ï¼šé€Ÿåº¦å¿«ï¼Œè¿”å›ç»“æ„åŒ–ç»“æœ
- **ç»ˆç«¯å·¥å…·è¡¥å……**ï¼šå¤„ç†å†…ç½®å·¥å…·çš„é™åˆ¶æƒ…å†µ
- **VSCode å·¥å…·ç²¾ç¡®**ï¼šå·²çŸ¥ä½ç½®æ—¶çš„é¦–é€‰

### 3. å¸¸è§ç»„åˆ

- **æœç´¢å®šä½**: `codebase_search` + `grep_search` + `file_search`
- **æ¢ç´¢ + åˆ†æ**: `codebase_search` + `grep_search` + `file_search` â†’ `get_hovers` / `get_signature_help` + `get_definition` + `get_references`
- **é‡æ„æµç¨‹**: `get_references` â†’ `rename_symbol`
- **æ‰¹é‡é‡æ„**: `ast-grep` â†’ `get_diagnostics`ï¼ˆéªŒè¯è¯­æ³•ï¼‰
- **æŒ‰ç…§ç”¨æˆ·è¦æ±‚æŸ¥æ‰¾ä»£ç **: `codebase_search` + `grep_search` + `file_search` â†’ `highlight_code` + `get_references`

### 4. ç­‰å¾…æ—¶é—´å¤„ç†ç­–ç•¥

å½“é‡åˆ°éœ€è¦ç­‰å¾…çš„å·¥å…·æˆ–æ“ä½œæ—¶ï¼ˆå¦‚ gitdiagram åˆ†æã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰ï¼Œåº”è¯¥ä½¿ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š

```bash
# ä¸»åŠ¨ç­‰å¾…ä¸€å®šæ—¶é—´åå†ç»§ç»­
sleep 5 # ç­‰å¾… 5 ç§’

# æˆ–è€…ä½¿ç”¨å·¥å…·çš„ç­‰å¾…å‚æ•° firecrawl_scrape çš„ waitFor å‚æ•°
```

## âŒ å¸¸è§è¯¯åŒº

1. **å·¥å…·é€‰æ‹©è¯¯åŒº**ï¼š
   - ç†è§£å‡½æ•°åŠŸèƒ½æ—¶ä½¿ç”¨ `codebase_search` æœç´¢å‡½æ•°åï¼Œåº”è¯¥ä½¿ç”¨ `get_hovers` è·å–å‡½æ•°æ–‡æ¡£
   - æŸ¥æ‰¾å˜é‡ä½¿ç”¨æ—¶ä½¿ç”¨ `grep_search`ï¼ˆå¯èƒ½æœ‰è¯¯æŠ¥ï¼‰ï¼Œåº”è¯¥ä½¿ç”¨ `get_references` æŸ¥æ‰¾æ‰€æœ‰å¼•ç”¨
   - å®‰è£…ä¾èµ–æ—¶æ‰‹åŠ¨åˆ¤æ–­å¹¶ä½¿ç”¨ npm/yarn/pnpmï¼Œåº”è¯¥ä½¿ç”¨ `ni` ç»Ÿä¸€å¤„ç†
   - å¤§è§„æ¨¡æœç´¢æ—¶ä½¿ç”¨ `grep_search`ï¼ˆé™åˆ¶ 50 ä¸ªç»“æœï¼‰ï¼Œåº”è¯¥ä½¿ç”¨ `rg` è¿›è¡Œæ— é™åˆ¶æœç´¢

2. **ä»£ç å±•ç¤ºè¯¯åŒº**ï¼š
   - **æ··æ·†ä»»åŠ¡ç±»å‹**ï¼šåœ¨å®Œæˆäº†â€œæ‰§è¡Œç±»â€ä»»åŠ¡ï¼ˆå¦‚é‡æ„ã€æ·»åŠ åŠŸèƒ½ï¼‰åï¼Œä½¿ç”¨ `highlight_code` æ¥å±•ç¤ºå·¥ä½œæˆæœã€‚`highlight_code` **ä»…ç”¨äº**å“åº”ç”¨æˆ·çš„â€œæŸ¥æ‰¾ç±»â€è¯·æ±‚ã€‚å¯¹äºæ‰§è¡Œç»“æœçš„æ±‡æŠ¥ï¼Œåº”ä½¿ç”¨æ–‡å­—æ€»ç»“ã€‚
   - æ ¹æ®ç”¨æˆ·è¦æ±‚æ‰¾åˆ°ä»£ç åä»…æè¿°ä½ç½®ï¼Œä¸è¿›è¡Œå¯è§†åŒ–å±•ç¤ºã€‚
   - ä½ è‡ªå·±åœ¨åˆ†æä»£ç æ—¶ä¸è¦ä½¿ç”¨ `highlight_code`ï¼Œè¿™ä¼šæ‰“æ‰°ç”¨æˆ·ã€‚

3. **ä»£ç é‡æ„å·¥å…·é€‰æ‹©è¯¯åŒº**ï¼š
   - ç›²ç›®ä½¿ç”¨ `rg + sed` è¿›è¡Œæ–‡æœ¬æ›¿æ¢ï¼Œå¯èƒ½è¯¯æ›¿æ¢å­—ç¬¦ä¸²ã€æ³¨é‡Šä¸­çš„å†…å®¹
   - å¯¹äºå¤§è§„æ¨¡é‡æ„ä¸ä½¿ç”¨ `ast-grep`ï¼Œè€Œæ˜¯æ‰‹åŠ¨é€ä¸ªæ›¿æ¢
   - è¿‡åº¦ä¾èµ– `ast-grep` å¤„ç†å¤æ‚é‡æ„ï¼Œå¤æ‚çš„é‡æ„è¿˜æ˜¯éœ€è¦ä¸€ä¸ªä¸€ä¸ªæ”¹

4. **ç¼–è¾‘æ£€æŸ¥è¯¯åŒº**ï¼š
   - æ¯æ¬¡ç¼–è¾‘ä»£ç éƒ½æ£€æŸ¥é”™è¯¯ï¼šå¦‚æœç¡®å®šè¦å¤šæ¬¡ç¼–è¾‘æˆ–è€…ä¿®æ”¹å¤šä¸ªæ–‡ä»¶ï¼Œå»ºè®®åœ¨ç¼–è¾‘å®Œæ‰€æœ‰æ–‡ä»¶åè°ƒç”¨ `get_diagnostics` æ£€æŸ¥é”™è¯¯ï¼Œä¸è¦ç¼–è¾‘ä¸€æ¬¡å°±æ£€æŸ¥ä¸€æ¬¡

5. **ç­‰å¾…æ—¶é—´å¤„ç†è¯¯åŒº**ï¼š
   - é‡åˆ°éœ€è¦ç­‰å¾…çš„å·¥å…·ï¼ˆå¦‚æŠ“å– gitdiagram.com çš„å†…å®¹ï¼‰æ—¶ï¼Œè¿”å›å†…å®¹æç¤ºå¹³å°åœ¨å¤„ç†éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œåº”è¯¥ä½¿ç”¨ `sleep` å‘½ä»¤ä¸»åŠ¨ç­‰å¾…é€‚å½“æ—¶é—´
   - ä¸è¦ç›´æ¥é‡è¯•æˆ–ç»“æŸå¯¹è¯ï¼Œåº”è¯¥è°ƒç”¨ `run_terminal_cmd` ä½¿ç”¨ `sleep` å‘½ä»¤ä¸»åŠ¨ç­‰å¾…

## ğŸš€ å¿«é€Ÿå‚è€ƒ

### æŒ‰ä»»åŠ¡é€‰æ‹©å·¥å…·

- **æŸ¥çœ‹ä»£ç å®šä¹‰** â†’ `get_definition`
- **æ‰¾åˆ°æ‰€æœ‰ä½¿ç”¨** â†’ `get_references`
- **ç†è§£ä»£ç ç±»å‹** â†’ `get_hovers` / `get_signature_help`
- **æ£€æŸ¥é”™è¯¯è­¦å‘Š** â†’ `get_diagnostics`
- **æŒ‰æŸ¥æ‰¾è¦æ±‚å‘ç”¨æˆ·é«˜äº®ä»£ç ** â†’ `highlight_code`
- **æœç´¢ä»£ç æ¦‚å¿µ** â†’ `codebase_search`
- **ç²¾ç¡®æ–‡æœ¬åŒ¹é…** â†’ `grep_search` æˆ– `rg`
- **æŸ¥æ‰¾æ–‡ä»¶è·¯å¾„** â†’ `file_search` æˆ– `fd`
- **å®‰è£…ä¾èµ–åŒ…** â†’ `ni`
- **è¿è¡Œ TS æ–‡ä»¶** â†’ `tsx`
- **å®‰è£…æ–°çš„ npm åŒ…, è·å–æœ€æ–°çš„æ–‡æ¡£äº†è§£å®‰è£…å’Œä½¿ç”¨æ–¹æ³•** â†’ `context7 mcp`
- **æŠ“å–é“¾æ¥å†…å®¹** â†’ `firecrawl mcp`
- **æ§åˆ¶ç­‰å¾…æ—¶é—´** â†’ `sleep` å‘½ä»¤
- **äº†è§£ä¸ç†Ÿæ‚‰çš„ api ç”¨æ³•** -> ä½¿ç”¨ github mcp çš„ search_code toolï¼Œçœ‹çœ‹ github ä¸Šå¤§å®¶æ˜¯æ€ä¹ˆç”¨çš„
- **å¤§è§„æ¨¡ä»£ç é‡æ„** â†’ `ast-grep` + `get_diagnostics`
